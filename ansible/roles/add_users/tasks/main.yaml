# Add defined users

- name: "Add groups"
  group:
    name: "{{ item }}"
  loop:
    - developers
    - docker


- name: "Add users"
  user:
    name: "{{ item }}"
    shell: '/bin/bash'
    groups: sudo,adm,developers,docker
    # password has been generated by "mkpasswd --method=sha-512" tool.
    password: '$6$khicm6Agv4$Y/.W28N9dULAPs8MFfPfm4I3ZKeN9YUuRTQ1u2iWeNfppYlt.tw5DYnHMcpR7mObMaMavD2edm62.5nhW9ms0.'
  loop: "{{ users }}"
  when: users is defined
  tags:
    - add_users


- name: "Add authorized_keys"
  authorized_key:
    user: "{{ item }}"
    state: present
    key: "{{ lookup('file', item+'.pub') }}"
  loop: "{{ users }}"
  when: users is defined
  tags:
    - add_authorized_keys